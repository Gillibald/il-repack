<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <TargetFrameworks>netcoreapp2.1;netstandard2.0;net40</TargetFrameworks>
    <!-- Support compiling on macOS and Linux because .NET Framework is not available -->
    <TargetFrameworks Condition="$(OS) != 'Windows_NT'">netcoreapp2.1</TargetFrameworks>
    <RootNamespace>ILRepacking</RootNamespace>
    <AssemblyName>ILRepack</AssemblyName>
    <OutputType Condition="'$(ILRepackExe)' != 'true'">Library</OutputType>
    <OutputType Condition="'$(ILRepackExe)' == 'true'">Exe</OutputType>
    <StartupObject Condition="'$(ILRepackExe)' == 'true'">ILRepacking.Application</StartupObject>
    <IsNetFullFramework Condition="$(TargetFramework.Contains('netstandard')) OR $(TargetFramework.Contains('netcoreapp'))">false</IsNetFullFramework>
    <IsNetFullFramework Condition="'$(IsNetFullFramework)' == ''">true</IsNetFullFramework>
    <DefineConstants Condition="'$(IsNetFullFramework)' == 'true'">$(DefineConstants);ISNETFULLFRAMEWORK;</DefineConstants>
    <CopyLocalLockFileAssemblies>true</CopyLocalLockFileAssemblies>
  </PropertyGroup>
  <ItemGroup Condition="'$(IsNetFullFramework)' == 'true'">
    <PackageReference Include="Mono.Posix" Version="4.0.0" />
  </ItemGroup>
  <ItemGroup Condition="'$(IsNetFullFramework)' != 'true'">
    <PackageReference Include="Mono.Posix.NETStandard" Version="1.0.0" />
  </ItemGroup>
  <ItemGroup Condition="'$(IsNetFullFramework)' == 'true'">
    <Reference Include="Microsoft.CSharp" />
    <Reference Include="System" />
  </ItemGroup>
  <ItemGroup>
    <PackageReference Include="sourcelink" Version="1.1.0">
      <PrivateAssets>all</PrivateAssets>
    </PackageReference>
    <EmbeddedResource Include="$(USERPROFILE)\.nuget\packages\sourcelink\1.1.0\tools\pdbstr.exe"></EmbeddedResource>
  </ItemGroup>
  <ItemGroup>
    <ProjectReference Include="..\deps\bamlparser\BamlParser.csproj" />
    <ProjectReference Include="..\deps\cecil\Mono.Cecil.csproj" />
    <ProjectReference Include="..\deps\fasterflect\src\Fasterflect.Netstandard\Fasterflect.Netstandard.csproj" />
  </ItemGroup>
</Project>