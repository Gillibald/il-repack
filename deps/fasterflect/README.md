Forked from https://github.com/HelloKitty/fasterflect #bf9f24f